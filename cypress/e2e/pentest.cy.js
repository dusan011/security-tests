import payload from "./xss.json";
import sqlpayload from "./sql.json";

describe('Pentesting XSS, SQL INJECTION', () => {
    xit('should detect existing xss vulnerability', () => {
      cy.visit('https://bwapp.hakhub.net/xss_post.php');
      cy.get('#login').type("bee");
      cy.get('#password').type("bug");
      cy.get('button').click();
      cy.visit('https://bwapp.hakhub.net/xss_post.php');
      cy.get('#firstname').type(payload.xss_1);
      cy.get('#lastname').type(payload.xss_1);
      cy.get('#main > form > button').click();
      cy.wait(5);
      cy.on('window:alert', (text) => {
        cy.log(text);
        expect(text).to.contains("XSS test");
      });
    })
    it('should detect existing SQL injection vulnerability', () => {
        cy.visit('https://bwapp.hakhub.net/sqli_1.php');
        cy.get('#login').type("bee");
        cy.get('#password').type("bug");
        cy.get('button').click();
        cy.visit('https://bwapp.hakhub.net/sqli_1.php');
        cy.get('#title').type(sqlpayload.sql_1);
        cy.get('p > button').click()
        cy.get('#main').should('contain', "Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '%'' at line 1");
      })
  })